{% extends "blog/blog_base.html" %}

{% load comments %}


{% block header %}
<h2> Blog Posts </h2>
{% endblock %}

{% block content %}
    {% if posts %}
        <ul>
            {% for post in posts %}
            <div class="title"><a href="{% url slug_view post.slug %}"> {{ post.title }} </a> </div>
                <ul>
                    <div class="blog_author">Posted by: {{ post.username }} </div>
                    <div class="blog_time">{{ post.created }}</div>
                    {% if post.body|length > 200 %}
                        <div class="blog_summary">{{ post.body|linebreaks|slice:":200" }} ...</div>
                    {% else %}
                        <div class="blog_summary">{{ post.body|linebreaks }} </div>
                    {% endif %}

                    {% get_comment_count for post as num_comments %}
                    <div class="blog_comments"> # of comments: {{ num_comments }} </div>
                </ul>
            {% endfor %}
        </ul>
    {% else %}
        <p>No blog posts are available.</p>
    {% endif %}

    <a href="{% url new_post %}">Create new blog post</a>

{% endblock %}
